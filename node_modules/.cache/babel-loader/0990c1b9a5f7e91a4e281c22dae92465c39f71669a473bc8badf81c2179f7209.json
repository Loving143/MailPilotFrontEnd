{"ast":null,"code":"import api from './api';\nexport const emailService = {\n  // Send emails to multiple recipients\n  sendEmails: async hrDetailsList => {\n    const response = await api.post('/email/send', hrDetailsList);\n    return response.data;\n  },\n  // Update email status\n  updateEmailStatus: async hrDetailsList => {\n    // The backend expects { hrDetails: [...] } structure\n    const requestData = {\n      hrDetails: hrDetailsList\n    };\n    console.log('Sending status update request:', JSON.stringify(requestData, null, 2)); // Debug log\n    const response = await api.put('/email/update/status', requestData);\n    return response.data;\n  },\n  // Generate and download Excel report\n  generateExcel: async () => {\n    try {\n      const response = await api.get('/email/generate/excel', {\n        responseType: 'blob',\n        // Important for file downloads\n        headers: {\n          'Accept': 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/octet-stream, */*'\n        }\n      });\n      console.log('Excel API response:', response); // Debug log\n      console.log('Response headers:', response.headers); // Debug log\n      console.log('Response data type:', typeof response.data); // Debug log\n      console.log('Response data size:', response.data.size); // Debug log\n\n      return response;\n    } catch (error) {\n      console.error('Excel generation API error:', error);\n\n      // If the API returns an error in JSON format, try to parse it\n      if (error.response && error.response.data instanceof Blob) {\n        try {\n          const text = await error.response.data.text();\n          console.log('Error response text:', text);\n\n          // Try to parse as JSON to get error message\n          try {\n            const errorData = JSON.parse(text);\n            throw new Error(errorData.message || errorData.data || 'Excel generation failed');\n          } catch (parseError) {\n            throw new Error(text || 'Excel generation failed');\n          }\n        } catch (textError) {\n          throw error;\n        }\n      }\n      throw error;\n    }\n  },\n  // Export emails as CSV (client-side conversion)\n  exportAsCSV: emailData => {\n    const headers = ['Recipient Email', 'Subject', 'Status', 'Date & Time', 'Name', 'Company', 'Mobile'];\n    const csvContent = [headers.join(','), ...emailData.map(email => [`\"${email.recipientEmail || email.to || ''}\"`, `\"${email.subject || ''}\"`, `\"${email.status || ''}\"`, `\"${email.sentAt || email.timestamp || ''}\"`, `\"${email.name || ''}\"`, `\"${email.company || ''}\"`, `\"${email.mobNo || ''}\"`].join(','))].join('\\n');\n    const blob = new Blob([csvContent], {\n      type: 'text/csv;charset=utf-8;'\n    });\n    const link = document.createElement('a');\n    const url = URL.createObjectURL(blob);\n    link.setAttribute('href', url);\n    link.setAttribute('download', `email_logs_${new Date().toISOString().split('T')[0]}.csv`);\n    link.style.visibility = 'hidden';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  },\n  // Add HR details\n  addHrDetails: async hrDetailsList => {\n    const response = await api.post('/email/add/hrDetails', {\n      hrDetails: hrDetailsList\n    });\n    return response.data;\n  },\n  // Quick send using recent email template\n  quickSend: async quickSendData => {\n    const response = await api.post('/email/quick-send', quickSendData);\n    return response.data;\n  },\n  // Send intent-based email\n  sendIntentEmail: async emailData => {\n    const response = await api.post('/email/send/intent-email', emailData);\n    return response.data;\n  },\n  // Fetch all emails for current user\n  fetchAllEmails: async () => {\n    const response = await api.get('/email/fetch/all');\n    return response.data;\n  },\n  // Fetch specific email by ID\n  fetchEmailById: async id => {\n    const response = await api.get(`/email/fetch/${id}`);\n    return response.data;\n  },\n  // Delete email log\n  deleteEmailById: async id => {\n    const response = await api.delete(`/email/delete/${id}`);\n    return response.data;\n  },\n  // Get email status options\n  getEmailStatuses: () => [{\n    value: 'EMAIL_SENT',\n    label: 'Email Sent'\n  }, {\n    value: 'EMAIL_RECEIVED',\n    label: 'Email Received'\n  }, {\n    value: 'CONTACTED_ON_PHONE',\n    label: 'Contacted On Phone'\n  }, {\n    value: 'Interview_Scheduled',\n    label: 'Interview Scheduled'\n  }, {\n    value: 'REJECTED',\n    label: 'Rejected'\n  }, {\n    value: 'HIRED',\n    label: 'Hired'\n  }]\n};","map":{"version":3,"names":["api","emailService","sendEmails","hrDetailsList","response","post","data","updateEmailStatus","requestData","hrDetails","console","log","JSON","stringify","put","generateExcel","get","responseType","headers","size","error","Blob","text","errorData","parse","Error","message","parseError","textError","exportAsCSV","emailData","csvContent","join","map","email","recipientEmail","to","subject","status","sentAt","timestamp","name","company","mobNo","blob","type","link","document","createElement","url","URL","createObjectURL","setAttribute","Date","toISOString","split","style","visibility","body","appendChild","click","removeChild","addHrDetails","quickSend","quickSendData","sendIntentEmail","fetchAllEmails","fetchEmailById","id","deleteEmailById","delete","getEmailStatuses","value","label"],"sources":["H:/Projects/MailPilotFrontEnd/MailPilotFrontEnd/src/services/emailService.js"],"sourcesContent":["import api from './api';\r\n\r\nexport const emailService = {\r\n  // Send emails to multiple recipients\r\n  sendEmails: async (hrDetailsList) => {\r\n    const response = await api.post('/email/send', hrDetailsList);\r\n    return response.data;\r\n  },\r\n\r\n  // Update email status\r\n  updateEmailStatus: async (hrDetailsList) => {\r\n    // The backend expects { hrDetails: [...] } structure\r\n    const requestData = { hrDetails: hrDetailsList };\r\n    console.log('Sending status update request:', JSON.stringify(requestData, null, 2)); // Debug log\r\n    const response = await api.put('/email/update/status', requestData);\r\n    return response.data;\r\n  },\r\n\r\n  // Generate and download Excel report\r\n  generateExcel: async () => {\r\n    try {\r\n      const response = await api.get('/email/generate/excel', {\r\n        responseType: 'blob', // Important for file downloads\r\n        headers: {\r\n          'Accept': 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/octet-stream, */*'\r\n        }\r\n      });\r\n      \r\n      console.log('Excel API response:', response); // Debug log\r\n      console.log('Response headers:', response.headers); // Debug log\r\n      console.log('Response data type:', typeof response.data); // Debug log\r\n      console.log('Response data size:', response.data.size); // Debug log\r\n      \r\n      return response;\r\n    } catch (error) {\r\n      console.error('Excel generation API error:', error);\r\n      \r\n      // If the API returns an error in JSON format, try to parse it\r\n      if (error.response && error.response.data instanceof Blob) {\r\n        try {\r\n          const text = await error.response.data.text();\r\n          console.log('Error response text:', text);\r\n          \r\n          // Try to parse as JSON to get error message\r\n          try {\r\n            const errorData = JSON.parse(text);\r\n            throw new Error(errorData.message || errorData.data || 'Excel generation failed');\r\n          } catch (parseError) {\r\n            throw new Error(text || 'Excel generation failed');\r\n          }\r\n        } catch (textError) {\r\n          throw error;\r\n        }\r\n      }\r\n      \r\n      throw error;\r\n    }\r\n  },\r\n\r\n  // Export emails as CSV (client-side conversion)\r\n  exportAsCSV: (emailData) => {\r\n    const headers = ['Recipient Email', 'Subject', 'Status', 'Date & Time', 'Name', 'Company', 'Mobile'];\r\n    const csvContent = [\r\n      headers.join(','),\r\n      ...emailData.map(email => [\r\n        `\"${email.recipientEmail || email.to || ''}\"`,\r\n        `\"${email.subject || ''}\"`,\r\n        `\"${email.status || ''}\"`,\r\n        `\"${email.sentAt || email.timestamp || ''}\"`,\r\n        `\"${email.name || ''}\"`,\r\n        `\"${email.company || ''}\"`,\r\n        `\"${email.mobNo || ''}\"`\r\n      ].join(','))\r\n    ].join('\\n');\r\n\r\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\r\n    const link = document.createElement('a');\r\n    const url = URL.createObjectURL(blob);\r\n    link.setAttribute('href', url);\r\n    link.setAttribute('download', `email_logs_${new Date().toISOString().split('T')[0]}.csv`);\r\n    link.style.visibility = 'hidden';\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  },\r\n\r\n  // Add HR details\r\n  addHrDetails: async (hrDetailsList) => {\r\n    const response = await api.post('/email/add/hrDetails', { hrDetails: hrDetailsList });\r\n    return response.data;\r\n  },\r\n\r\n  // Quick send using recent email template\r\n  quickSend: async (quickSendData) => {\r\n    const response = await api.post('/email/quick-send', quickSendData);\r\n    return response.data;\r\n  },\r\n\r\n  // Send intent-based email\r\n  sendIntentEmail: async (emailData) => {\r\n    const response = await api.post('/email/send/intent-email', emailData);\r\n    return response.data;\r\n  },\r\n\r\n  // Fetch all emails for current user\r\n  fetchAllEmails: async () => {\r\n    const response = await api.get('/email/fetch/all');\r\n    return response.data;\r\n  },\r\n\r\n  // Fetch specific email by ID\r\n  fetchEmailById: async (id) => {\r\n    const response = await api.get(`/email/fetch/${id}`);\r\n    return response.data;\r\n  },\r\n\r\n  // Delete email log\r\n  deleteEmailById: async (id) => {\r\n    const response = await api.delete(`/email/delete/${id}`);\r\n    return response.data;\r\n  },\r\n\r\n  // Get email status options\r\n  getEmailStatuses: () => [\r\n    { value: 'EMAIL_SENT', label: 'Email Sent' },\r\n    { value: 'EMAIL_RECEIVED', label: 'Email Received' },\r\n    { value: 'CONTACTED_ON_PHONE', label: 'Contacted On Phone' },\r\n    { value: 'Interview_Scheduled', label: 'Interview Scheduled' },\r\n    { value: 'REJECTED', label: 'Rejected' },\r\n    { value: 'HIRED', label: 'Hired' }\r\n  ]\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}